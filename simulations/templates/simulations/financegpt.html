<form id="financegpt-form">
    <textarea
        id="gpt_prompt"
        name="gpt_prompt"
        rows="4"
        cols="50"
        placeholder="Ask about stock markets, investment strategies, etc."
    ></textarea>
    <button type="submit" class="button">Ask FINGPT</button>
</form>

<div class="card2">
    <h2>FINGPT Response:</h2>
    <div class="response" id="response-box">Waiting for response...</div>
</div>

<script>
    document.getElementById("financegpt-form").addEventListener("submit", function(event) {
        event.preventDefault();  // Prevent form from reloading the page

        let prompt = document.getElementById("gpt_prompt").value;
        let responseBox = document.getElementById("response-box");

        responseBox.innerHTML = "Generating response..."; // Show loading message

        fetch("{% url 'financegpt_view' %}", {
            method: "POST",
            headers: {
                "X-CSRFToken": "{{ csrf_token }}",
                "Content-Type": "application/x-www-form-urlencoded",
            },
            body: "gpt_prompt=" + encodeURIComponent(prompt),
        })
        .then(response => response.json())
        .then(data => {
            responseBox.innerHTML = data.response;  // Show GPT response
        })
        .catch(error => {
            responseBox.innerHTML = "Error getting response!";
        });
    });
</script>
